# 億級用戶系統為什麼多選 MySQL？為什麼不是 PostgreSQL？

## 一、MySQL 是億級 Web 系統的實戰首選

### ✅ 優勢總覽：
1. **成熟穩定，工具鏈完備**
   - 發展超過 25 年，支援廣泛，RDS、ProxySQL、Sharding 中間件多數為其打造。
2. **垂直擴展能力強**
   - 大型主機（高核數、大內存、SSD）配合優化設計，單機可撐上億級用戶。
3. **分庫分表方案成熟**
   - MyCat、ShardingSphere、TDDL 等實務落地多年。
4. **一致性佳，ACID 支援**
   - 適用於金融、交易、排行榜等業務核心邏輯。
5. **人才多，學習曲線低**
   - 工程師熟悉度高，公司內部訓練與運維更有效率。
6. **緩存系統搭配佳**
   - Redis/CDN 擋在前端，MySQL 實際處理請求已削峰。
7. **雲平台支援完善**
   - 幾乎所有主流雲服務商（AWS, GCP, Azure）都提供高度優化的 MySQL RDS 與周邊工具。
8. **社群與經驗累積豐富**
   - StackOverflow、部落格、論壇等遇到問題幾乎都有現成解法與經驗分享。

### 🚀 單機資料庫能夠承載的參考指標（實際測過）

#### 資源條件與效能對照：

| 資源條件 | 每秒 QPS（查詢） | 日活（DAU）級別 | 說明 |
|----------|----------|------------------|------|
| 8 核 32G RAM + NVMe SSD | 5~10 萬 QPS | 約 100~300 萬 DAU | 高命中索引、主鍵查詢為主 |
| 16 核 64G RAM + RAID SSD | 10~20 萬 QPS | 約 500~800 萬 DAU | 多索引查詢、複雜分頁、JOIN 較少 |
| 32 核 128G RAM + 專用機 | 30~50 萬 QPS | 約 1000~2000 萬 DAU | 高優化表設計 + 主從複製分擔讀壓 |

#### 📊 各主流資料庫實測承載對照：

| 資料庫 | 單表規模 | 查詢 QPS | 寫入 TPS | 運行情境 |
|--------|-----------|----------|-----------|--------------------------|
| MySQL | ~5,000 萬 | 2000+ | 300+ | 使用索引、分頁、主從架構 |
| PostgreSQL | ~2,000 萬 | 1500+ | 200+ | 使用 connection pool、適當索引 |
| SQLite | ~10 萬 | 200+ | 100+ | 單機內嵌輕量使用 |

> ⚠ 效能依賴於資料表設計、索引規劃、查詢語句品質、硬體 IOPS 以及連線池配置等多項因素。

---

## 二、為什麼不是 PostgreSQL？

### 🔍 PostgreSQL 的技術強項：
- 查詢優化器更聰明
- MVCC 與事務隔離等級高
- JSONB、地理、時序、向量型資料支援強
- 插件擴展性強（PostGIS、Citus、TimescaleDB）

### ❗ 但為何不常見於億級 Web 系統？

| 項目 | MySQL | PostgreSQL |
|------|-------|------------|
| 生態系統 | 中間件、工具多 | 工具偏學術 / 少數場景專用 |
| 高併發效能 | 查詢執行簡單快 | 查詢器較複雜，效率不穩定 |
| 分庫分表 | 大量解法實戰中 | 僅有 FDW/Citus 等，高門檻 |
| 開發人力 | 熟手多、成本低 | 少人會，學習曲線高 |
| 雲平台支援 | 各大平台 RDS 全支援 | 有支援但非主推 |
| 適用場景 | 高併發交易、電商遊戲 | 複雜查詢、分析系統、GIS、金融 |

### ⚡ 高併發下 MySQL 更「粗暴實用」
PostgreSQL 雖然查詢更聰明，但在簡單查詢 + 高併發場景下，MySQL 的查詢執行計畫快狠準。實戰上，經過調校後的 MySQL 在高併發單表查詢上的 TPS 表現可能更高，因為它少做一點「聰明的優化」。

### ⚡ 龍頭平台主推 MySQL

AWS RDS、GCP、阿里雲、騰訊雲、華為雲的主推產品是 MySQL，就連 ByteDance 的 OceanBase 也是 MySQL 相容。<b>你要 scale 時，直接用 RDS for MySQL + ProxySQL 一路橫向擴展超方便。</b>

### ⚡ PostgreSQL 更適合數據倉儲 / 分析型場景

億級用戶場景偏 OLTP（大量小資料查寫），PostgreSQL 雖然也支援 OLTP，但更偏向 OLAP（如時序數據、報表、GIS）。

### 📌 核心結論：
> PostgreSQL 更強，但 MySQL 更穩。前者像「進階法寶」，後者是「一線主力」。
---

## 三、總結：選擇的本質是 "生產效率與穩定性"

- 雖然 PostgreSQL 功能更完整、彈性更強，但 MySQL **上手更快、穩定成熟、團隊容易配合**，對於快速推進產品尤為關鍵。
- 對於大多數 Web 產品來說，MySQL 已能涵蓋 90% 的需求，並具備強大社群支援與實戰經驗累積。
- 真正適合 PostgreSQL 的情境，往往是：
  - 複雜查詢 / 多表 JOIN 報表系統
  - AI/推薦系統使用的向量資料查詢（pgvector）
  - 地理定位與 GIS 應用（PostGIS）
  - 嚴格的金融結算與時序歷史數據儲存

---

## 想法延伸：

- 若未來要打全球多地部署、容災與同步、分布式交易系統，可再考慮：
  - **TiDB（MySQL 相容分布式 DB）**
  - **CockroachDB / Yugabyte（Postgres 相容）**
  - **Google Spanner（跨區一致性）**

> 💡 最佳實踐：百萬～千萬級用戶起步，用 MySQL 就夠。等真正出現瓶頸，再根據痛點局部改進或分流，是業界通用的穩健策略。
