# Collision Research

在動態變化較多的場景下，例如遊戲中的物體頻繁移動、進入或退出場景，推薦的空間數據結構需要能夠快速進行更新和查詢。以下是幾種適合動態場景的數據結構及其優劣分析：

1. 動態四叉樹/八叉樹 (Dynamic Quad Trees/Octrees)
優勢：四叉樹（2D）和八叉樹（3D）可以動態劃分空間，根據物體的空間位置進行調整。它們的結構允許對象在場景中移動時局部更新區域，而無需重新構建整個數據結構。
應用場景：適用於有較多對象進入、移出場景，且物體位置變化頻繁的情況。因為它們按區域劃分，對局部區域的更新較為高效。
劣勢：當物體的分佈密集度或動態性過高時，可能需要頻繁重新劃分節點，造成性能開銷。動態場景中可能需要優化樹的平衡。
2. Bounding Volume Hierarchies (BVH)
優勢：BVH 結構通過分層包圍盒來進行碰撞檢測。每個節點的包圍盒包含其子節點或物體的邊界，從而能夠有效減少無效的碰撞檢測。在物體不斷移動時，包圍盒只需部分更新，避免了大量的重建。
應用場景：適合物體數量大、但物體之間變化幅度相對較小的場景，例如一些物體會頻繁移動，但整體分佈變化不大。靜態或少量動態物體的場景更為理想。
劣勢：如果物體頻繁變化位置，BVH 需要重新調整包圍盒，這會導致一定的性能消耗，特別是在高頻更新的場景中。
3. 動態 AABB 樹 (Dynamic Axis-Aligned Bounding Box Tree)
優勢：AABB 樹是 BVH 的一種特殊形式，其中包圍盒是軸對齊的矩形或立方體。動態 AABB 樹專為高頻更新設計，能夠快速處理插入、刪除和移動物體，且更新代價相對較低。其結構易於平衡，適合頻繁的動態場景。
應用場景：適用於有大量對象且經常變換位置的動態場景，特別是需要高效處理碰撞檢測的遊戲系統。很多遊戲引擎（如 Box2D）會採用這種結構來處理物理碰撞。
劣勢：AABB 適用於軸對齊的包圍盒，對於旋轉或不規則形狀的物體，可能需要更多的額外處理。
4. Spatial Hashing (空間哈希)
優勢：空間哈希是通過將空間劃分為固定大小的網格或桶來快速定位物體，並且每個物體基於其位置對應到不同的哈希桶。當物體在空間中移動時，只需要將其從一個桶移到另一個桶，這樣的更新非常迅速。
應用場景：非常適合於需要頻繁更新物體位置且物體之間交互頻繁的場景，尤其是需要快速查找鄰近物體的情況。這在網格大小適當的情況下，可以實現高效的動態碰撞檢測。
劣勢：如果物體大小差異較大或空間分佈不均，選擇合適的網格尺寸會變得困難，且可能導致哈希碰撞或過多的鄰居檢查。
5. 混合結構
優勢：在某些情況下，可以使用混合數據結構來應對動態場景。例如，四叉樹與 AABB 結合，利用四叉樹進行粗略的空間劃分，並使用 AABB 樹進行更精細的碰撞檢測。這種組合可以平衡更新速度和檢測精度。
應用場景：這種結構適合非常複雜的場景，特別是當你需要同時考慮大範圍的動態變化和精確的碰撞檢測時。
結論

在動態變化較多的場景中，推薦使用 動態 AABB 樹 或 動態四叉樹/八叉樹。它們能夠快速處理物體插入、刪除和移動，並且更新開銷較低，是碰撞系統中高效且實用的選擇。對於特定場景，還可以考慮空間哈希來進行快速鄰近查找。如果是特別複雜的場景，則可以嘗試使用混合數據結構來達到更好的平衡效果。